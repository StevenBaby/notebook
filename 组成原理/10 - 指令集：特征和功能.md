# 10 - 指令集：特征和功能

计算机指令最重要的元素是操作码，它指明将完成的操作，源和目的操作数的引用方式，并通常隐式指明下一条指令的来源。

操作码指定的操作，一般有如下类型：

- 算术逻辑运算
- 在两个寄存器、寄存器和存储器或存储器两个位置之间传送数据
- 输入/输出
- 控制

操作数引用方式指定如何寻找被操作数据的寄存器或存储器位置。数据类型可以式地址、数值、字符或逻辑数据。

各类处理器中的一个普遍的体系结构特征是栈的使用，栈对程序员是可见或是不可见的。栈用于管理过程中的调用和返回，也可以用来提供另一种寻址寄存器的方式。栈的基本操作是入栈和出栈，以及在栈顶部一或两个位置上完成的操作。一般来说，栈都实现为从高地址向低地址增长。

字节可寻址的处理器可分为大端、小端、双端这几类。如果多字节的数值是以最高有效字节存于最低地址值的字节来顺序存储，则称为小端。既支持大端又支持小端的处理器是双端处理器。

对一台计算机而言，把计算机设计人员和计算机编程人员衔接而又区分开的分界是机器指令集。以设计者观点看，机器指令集提出了对中央处理器(CPU)的功能性需求；实现CPU任务大部分都设计机器指令集的实现。从用户观点来看，选取以机器语言（汇编语言）变成的用户必定要通晓机器所直接支持的寄存器和存储器结构、数据类型，以及算术逻辑单元的功能。

## 机器指令特征

CPU的操作由它所执行的指令确定，这些指令称为**机器指令**或计算机**指令**。CPU能执行的各种不同指令的集合称为CPU指令集

每条机器指令必定包含处理器执行该指令所需的信息。机器指令要素，如下所示：

- 操作码：指定将要完成的操作，ADD,I/O 等
- 源操作数引用：操作会涉及一个或多个源操作数，这是操作所需的输入
- 结果操作数引用：操作可能产生一个结果
- 下一条指令引用：它告诉处理器这条指令完成之后到哪儿去取下一条指令

待取的下一条指令可能是一个实地址，也可能是个虚地址，这取决于具体的计算机体系结构。

源和结果操作数可能位于如下四个范围内：

- 主存或虚存：
- 处理器寄存器：除极少数例外，一个处理器总有一个或多个能被机器指令所访问的寄存器。若只有一个寄存器，对他的引用可以是隐式的；若不止一个寄存器，则每个寄存器要指定一个唯一的名字或编号，指令提供所需寄存器的编号。
- 立即数：操作数的值保存在当前执行指令的某个字段中
- IO设备：需要IO操作的指令必须指定IO模块设备。若使用存储器映射IO方式，那么形式上将是另一个主存或虚存地址


计算机内部，指令由一个位串来表示。大多数指令集使用不止一种指令格式。指令执行期间，一条指令被读入到处理器的**指令寄存器(IR)**中，处理器必须能从各个指令字段中提取数据来完成所需操作。

操作码被缩写成助记符，一般如下：
| 操作码 | 操作 |
| - | - |
|ADD| 加|
|SUB| 减|
|MUL| 乘|
|DIV| 除|
|LOAD| 由存储器装入|
|STOR| 保存到存储器|

操作数也可用符号表示。例如

ADD R,Y

会意味着，**它将存储器Y位置中的数据值加到寄存器R上**。

X = X + Y

这条语句指挥计算机将存于Y的值加到存于X的值并将结果放入X中。以下面三条指令完成

- 将存储器位置 X的内容装入一个寄存器
- 把存储器位置Y的内容与上述寄存器的内容相加并保存到该寄存器中
- 将此寄存器的内容存入存储器X中

可以将指令分类成：

- 数据处理：算术逻辑指令
- 数据存储：存储器指令
- 数据传送：I/O指令
- 控制：测试和分支指令

最简单的还是单地址指令。为使它能工作，第二个地址必须是隐含的，其隐含的的地址被称为**累加器**的CPU寄存器。

涉及每条指令地址数目选择的设计权衡，被其他因素复杂化了。一个需要考虑的设计问题是引用到存储器位置还是寄存器。因为寄存器的数目总是不太多，因此寄存器引用只需要少数几位即可。

- 操作指令表：应提供多少和什么样的操作，操作将是何等复杂
- 数据类型：对哪种数据类型完成操作
- 指令格式：指令的长度，地址数目、各个字段的大小
- 寄存器：能被指令访问的处理器寄存器数目以及他们的用途
- 寻址：指定操作数地址的产生方式

## 操作数类型

机器指令对数据进行操作，数据通常分为：地址、数值、字符、逻辑数据。

## 操作类型

不同的机器，其操作码的数目变动时很大的。操作的典型分类包括：数据传送、算术、逻辑、转换、输入/输出，系统控制，控制转移。

## 参考资料

- [1] 计算机组成与体系结构 [美] William Stallings 著
